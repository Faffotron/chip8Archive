<h1 id="itdoesnttastelikeapls...">It Doesn&#8217;t Taste Like APLs&#8230;</h1>

<p>Applejak is a very, very small interpreter for a subset of the <a href="https://en.wikipedia.org/wiki/K_%28programming_language%29">K programming language</a> which runs on the Super CHIP-8 virtual machine; one of the most widely-ported VMs in existence. It was written in Octo Assembly Language as part of <a href="http://octojam.com/">Octojam 7</a>.</p>

<p>To cram this program (and all of its working buffers) into 4kb of RAM, I had to cut many corners. Error-handling is rudimentary-to-nonexistent. There&#8217;s no composition, projection, bracket-application, lambdas, or dictionary types. Data consists of numbers (unsigned bytes) and lists, which may contain at most 16 elements. The workspace has room for 64 &#8220;atoms&#8221;- numbers or lists- and intermediate values may be stored in one of 6 variables. Expect some bugs.</p>

<p>If you don&#8217;t know anything about K or APL, please don&#8217;t let this misshapen little stump of an interpreter color your opinions. Perhaps you could try one of <a href="https://github.com/JohnEarnest/ok">my other K interpreters</a>?</p>

<h2 id="controls">Controls</h2>

<p>CHIP-8 does not have an ordinary keyboard interface; just a hex keypad. Thus, to enter an expression at Applejak&#8217;s REPL, you use a menu-driven tree-builder. Cycle between choices with the up and down cursor keys (or W/S), and confirm a selection by pressing the right cursor key (or D). On mobile devices, swipe up, down, or right, respectively. Choices that are not yet &#8220;confirmed&#8221; will be drawn with an inverted background.</p>

<p>At the top level, you can choose between the following types of tree nodes:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"> Symbol      </th>
	<th style="text-align:left;"> Name    </th>
	<th style="text-align:left;"> Meaning                        </th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"> <img src="font-chars/tok_0.png" alt="num" /> </td>
	<td style="text-align:left;"> Number    </td>
	<td style="text-align:left;"> Add a single unsigned integer (0&#8211;255).                </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/tok_1.png" alt="var" /> </td>
	<td style="text-align:left;"> Variable reference </td>
	<td style="text-align:left;"> Choose one of the variables X,Y,Z,A,B,C and retrieve its value (if any).        </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/tok_2.png" alt="set" /> </td>
	<td style="text-align:left;"> Variable assignment </td>
	<td style="text-align:left;"> Choose a variable name, and enter an expression after the colon (:)         </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/tok_3.png" alt="mon" /> </td>
	<td style="text-align:left;"> Monadic verb  </td>
	<td style="text-align:left;"> Choose a monad (see below) followed by an input expression.           </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/tok_5.png" alt="dya" /> </td>
	<td style="text-align:left;"> Dyadic verb   </td>
	<td style="text-align:left;"> Choose a left expression (in parentheses), a dyad (see below), and a right expression.    </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/tok_6.png" alt="adv" /> </td>
	<td style="text-align:left;"> Adverb    </td>
	<td style="text-align:left;"> Choose a left expression (in parentheses), a dyad, an adverb (see below), and a right expression.  </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/tok_7.png" alt="lst" /> </td>
	<td style="text-align:left;"> List    </td>
	<td style="text-align:left;"> Enter a series of expressions, separated by semicolons (;) and terminated by a close parenthesis ()). </td>
</tr>
</tbody>
</table>

<h2 id="monads">Monads</h2>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"> Symbol      </th>
	<th style="text-align:left;"> Name </th>
	<th style="text-align:left;"> Meaning                              </th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_18.png" alt="\*" /> </td>
	<td style="text-align:left;"> First </td>
	<td style="text-align:left;"> Get the first element of a list. Identity for non-lists.                  </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_19.png" alt="! " /> </td>
	<td style="text-align:left;"> Iota </td>
	<td style="text-align:left;"> Generate a list from 0 up to a number N.                      </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_20.png" alt="\*" /> </td>
	<td style="text-align:left;"> Where </td>
	<td style="text-align:left;"> For each number in a list, generate that many copies of its index. For 1/0 lists, this produces a list of the indices of 1s. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_21.png" alt="\|" /> </td>
	<td style="text-align:left;"> Reverse </td>
	<td style="text-align:left;"> Generate a new list with the items of an input list in reverse-order.              </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_22.png" alt="~ " /> </td>
	<td style="text-align:left;"> Not  </td>
	<td style="text-align:left;"> Logically invert any numeric arguments. Recursively descends into list arguments. (Right-atomic.)       </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_23.png" alt=", " /> </td>
	<td style="text-align:left;"> Enlist </td>
	<td style="text-align:left;"> Make a length-1 list containing any item.                     </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_24.png" alt="r " /> </td>
	<td style="text-align:left;"> Length </td>
	<td style="text-align:left;"> Get the number of items in a list.                       </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_32.png" alt="? " /> </td>
	<td style="text-align:left;"> Random </td>
	<td style="text-align:left;"> Given a number N, generate a list of N random bytes.                   </td>
</tr>
</tbody>
</table>

<h2 id="dyads">Dyads</h2>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"> Symbol </th>
	<th style="text-align:left;"> Name </th>
	<th style="text-align:left;"> Meaning </th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_25.png" alt="+ " /> </td>
	<td style="text-align:left;"> Plus* </td>
	<td style="text-align:left;"> Add two unsigned bytes. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_26.png" alt="- " /> </td>
	<td style="text-align:left;"> Minus* </td>
	<td style="text-align:left;"> Subtract two unsigned bytes. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_27.png" alt="^ " /> </td>
	<td style="text-align:left;"> XOR* </td>
	<td style="text-align:left;"> Bitwise Exclusive OR of two unsigned bytes. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_20.png" alt="& " /> </td>
	<td style="text-align:left;"> Min* </td>
	<td style="text-align:left;"> Minimum of two unsigned bytes. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_21.png" alt="\|" /> </td>
	<td style="text-align:left;"> Max* </td>
	<td style="text-align:left;"> Maximum of two unsigned bytes. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_28.png" alt="< " /> </td>
	<td style="text-align:left;"> Less* </td>
	<td style="text-align:left;"> 1 if X is less than Y; otherwise 0. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_29.png" alt="> " /> </td>
	<td style="text-align:left;"> More* </td>
	<td style="text-align:left;"> 1 if X is more than Y; otherwise 0. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_30.png" alt="= " /> </td>
	<td style="text-align:left;"> Equal* </td>
	<td style="text-align:left;"> 1 if X equals Y; otherwise 0. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_23.png" alt=", " /> </td>
	<td style="text-align:left;"> Join </td>
	<td style="text-align:left;"> Combine two lists or numbers into one flat list. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_24.png" alt="r " /> </td>
	<td style="text-align:left;"> Take </td>
	<td style="text-align:left;"> Generate a list of the first X items of list Y, repeating as necessary, or X copies of an atom Y. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_31.png" alt="_ " /> </td>
	<td style="text-align:left;"> Drop </td>
	<td style="text-align:left;"> Generate a copy of Y after removing the first X items. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_33.png" alt="@ " /> </td>
	<td style="text-align:left;"> At  </td>
	<td style="text-align:left;"> Index elements Y from list X recursively. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_22.png" alt="~ " /> </td>
	<td style="text-align:left;"> Match </td>
	<td style="text-align:left;"> 1 if X and Y are recursively identical; otherwise 0. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_32.png" alt="? " /> </td>
	<td style="text-align:left;"> Find </td>
	<td style="text-align:left;"> Return the index at a list X which matches Y; otherwise return an index 1 past the end of X. </td>
</tr>
</tbody>
</table>

<p>* an &#8220;atomic&#8221; dyad which will recursively penetrate to elements of lists. Adding a number to a list will add the number to each element of a list, while adding a list to a list will zip together matching elements of each list.</p>

<h2 id="adverbs">Adverbs</h2>

<p>Adverbs are verbs which modify the behavior of other verbs. In this case, they provide ways of applying dyads to every element of a list:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"> Symbol      </th>
	<th style="text-align:left;"> Name </th>
	<th style="text-align:left;"> Meaning                  </th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_36.png" alt="/ " /> </td>
	<td style="text-align:left;"> Over </td>
	<td style="text-align:left;"> Apply the verb between each element of a list, and return the final result. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_37.png" alt="\ " /> </td>
	<td style="text-align:left;"> Scan </td>
	<td style="text-align:left;"> Like &#8220;Over&#8221;, but accumulate a list of intermediate results.     </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/char_35.png" alt="' " /> </td>
	<td style="text-align:left;"> Each </td>
	<td style="text-align:left;"> Apply the verb between corresponding items of the left and right lists.  </td>
</tr>
</tbody>
</table>

<h2 id="errors">Errors</h2>

<p>When Applejak crashes, it will attempt to display an error message. If you see an error message which does not look like one of the following, it suggests memory corruption. Whoopsie-doodle.</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"> Symbol      </th>
	<th style="text-align:left;"> Name   </th>
	<th style="text-align:left;"> Meaning                 </th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"> <img src="font-chars/err_0.png" alt="ws " /> </td>
	<td style="text-align:left;"> Workspace Full </td>
	<td style="text-align:left;"> Your calculation occupied too many atoms.         </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/err_2.png" alt="len" /> </td>
	<td style="text-align:left;"> Length Error </td>
	<td style="text-align:left;"> Tried to construct a list that is too large to fit in a workspace &#8220;slot&#8221;. </td>
</tr>
<tr>
	<td style="text-align:left;"> <img src="font-chars/err_3.png" alt="typ" /> </td>
	<td style="text-align:left;"> Type Error  </td>
	<td style="text-align:left;"> Tried to apply a verb or adverb to inappropriate datatypes.    </td>
</tr>
</tbody>
</table>

<p>This program has also been published on <a href="https://internet-janitor.itch.io/applejak">itch.io</a>.</p>
